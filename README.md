# E-commerce Site of Hardware and Landscaping Supplies Business

​
<p align="center" width="100%"> 
<img src="readme_docs/images/ecommerce_image.png" alt="project image" width=""/>
</p>

<span style="font-weight:bold; font-size:16px">Project Brief</span>
<p> This project is for the design and deployment of a functional E-commerce website for a business which supplies materials, hardware and tools primarily in the areas of Agriculture, Landscaping and construction.</p>


[This is an external link to the site](https://tw-shop.herokuapp.com/)


<br>

<span style= "font-weight:bold; font-size:16px">Origins of the project</span>
<p> The business has an established traditional bricks and mortar store but is looking to enter the E-commerce space to offset the potential impacts of a slow down in the construction sector related to potential recession and new enviromental rules relating to certain products that they currently sell. </p>

<span style="font-weight:bold; font-size:16px">A proposed solution.</span>
<p>The proposed plan is to design an E-commerce solution and marketing strategy to attract and retain new customers.</p>

<br>

<p align="center" width="100%"> 
<img src="readme_docs/images/screenshot.png" alt="screen shot of site" width=""/>
</p>



## Contents
​
- [Tommy Williamson Landscape & Agri Supplies](#contents)
  - [Contents](#contents)
  - [UX](#ux)
    - [Project Goals](#project-goals)
    - [User Stories](#user-stories)
    - [User Requirements and Expectations](#user-requirements-and-expectations)
      - [Requirements](#requirements)
      - [Expectations](#expectations)
    - [Design Choices](#design-choices)
      - [Fonts](#fonts)
      - [Colours](#colours)
      - [Images](#images)
      - [Agile Methodology](#agile-methodology)
  - [Marketing Strategy](#marketing-strategy)
    - [SEO](#seo---search-engine-optimization)
  - [Wireframes](#wireframes)
    - [Site Layout](#site-layout)
  - [Information Architecture](#information-architecture)
  - [Technologies](#technologies)
    - [Languages](#languages)
    - [Libraries & Frameworks](#libraries--frameworks)
    - [Tools](#tools)
  - [Features](#features)
    - [Implemented Features](#implemented-features)
    - [Future Features](#future-features)
  - [Development](#development)
    - [bUg5 & (F)ixes](#bugs--fixes)
  - [Testing](#testing)
    - [User Test Information](#user-test-information)
  - [Deployment](#deployment)
    - [Final Deployment](#final-deployment)
    - [Cloning](#cloning)
  - [Credits](#credits)
    - [Image editing](#image-editing)
    - [Code ideas](#code-ideas)
  

​
---
​

## UX
​
### **Project Goals**
​
<p>Development of a fully functional E-commerce site taking into account User Stories originating from the Agile design process.</p>
​
### **User Stories**
<p>The project was designed using the concepts of the Agile approach. A project was opened on Github and linked to the repository.</p>

USER STORIES:​
<p>I have attached a link to the User Stories and their status.</p>

[Link to User Stories](readme_docs/user_stories/User%20Stories.pdf)

|GitHub Link |	Issue Type |	Description |	Tested |	Completed |
|------------|-------------|--------------|--------|------------|    
|https://github.com/TNolan01/tommy1/issues/1| 	USER STORY |	As a shopper I can register and new account with login features.|		
|https://github.com/TNolan01/tommy1/issues/2| USER STORY	| As a shopper I can view a list of products for sale.	|	
|https://github.com/TNolan01/tommy1/issues/3|	USER STORY |	As a shopper I can sort and view products via categories to easily find what I am looking for.|		
|https://github.com/TNolan01/tommy1/issues/4|	USER STORY	| As a shopper I can register and new account with login features. |		
|https://github.com/TNolan01/tommy1/issues/5|	USER STORY	| As a shopper I can purchase items I have put in my basket.|		
|https://github.com/TNolan01/tommy1/issues/6|	USER STORY	 | As a shopper I can review my order before completing my purchase. |		
|https://github.com/TNolan01/tommy1/issues/7|	USER STORY	| As a shopper I will receive an email to confirm my purchase. |		
|https://github.com/TNolan01/tommy1/issues/8|	USER STORY | As a shopper I can sign up to receive details of special offers.|		
|https://github.com/TNolan01/tommy1/issues/9|	USER STORY |As a shopper I can browse the site of phone, tablet, and desktop screens.|		
|https://github.com/TNolan01/tommy1/issues/10| USER STORY |	As a visitor I can view and navigate the site with ease.|		
|https://github.com/TNolan01/tommy1/issues/11|	USER STORY |	As a site user I can see notification messages so I know the site is aware of the actions I have taken and these actions are confirmed.|		
|https://github.com/TNolan01/tommy1/issues/12|	USER STORY |	As a returning user the site will remember my address for fast checkout.		
|https://github.com/TNolan01/tommy1/issues/13|	USER STORY |As the site owner I can edit and update the details of products and prices.		
|https://github.com/TNolan01/tommy1/issues/14|	USER STORY	|As the site owner I can remove a product or products which are no longer available.		
|https://github.com/TNolan01/tommy1/issues/15|	USER STORY	|As the site owner I can add new product(s) to the site.		


​<br>

[Back to content](#contents)

---
​
### User Requirements and Expectations
​
#### **Requirements**
​
- Visually pleasant site design and layout.
- Easy site navigation.
- Content laid out in a simple and clear way on both mobile and larger screens.
- Self-explanatory icons where text is absent.
- Abilty to purchase products.
​
#### **Expectations**
​
- Easy to use interface.
- Clear and easy to read data.
- E-commerce functionality.

​<br>
[Back to content](#contents)

---
​
### **Design Choices**

<p> In this section I set out some of the design choices I made for the front end of the project </p>
​

#### **Fonts**
I used three different fonts from the Google Fonts library.


​```font-family: Lato font - from Google Fonts``` <br>
```font-family: Nunito font - from Google Fonts``` <br>
```font-family: Gloria Halleujah font - from Google Fonts``` <br>

<br>
<p align="center" width="100%"> 
<img src="readme_docs/images/project_fonts.png" alt="fonts for site" width=""/>
</p>
<br>
<p>Lato was used as the primary font with Nunito used on Carousel items and areas where intention was to break text statements or questions where the site users attention was required to confirm an action, such as the All_Auth templates.</p> 


<br>

#### **Images**
<p>The business has an existing logo image. I have incorporated this into the site header but ideally I would like to design a new logo.</p> 
<br>

<p align="center" width="100%"> 
<img src="readme_docs/images/company_logo.jpg" alt="logo for business" width=""/>
</p>

<br>
<p>A Favicon icon package was created using my drawing of the one of the companies delivery trucks as inspiration. The business has always used the same color scheme on its vechicles and as such they are an identifiable symbol of the business.</p> 

<br>

<p align="center" width="100%"> 
<img src="media/favicon/android-chrome-192x192.png" alt="logo for website" width=""/>
</p>

<br>

#### **Color Scheme**
<p>The front-end is styled inline with an existing color scheme which they employ across company uniforms and the vechicles. My intial design process was leaning towards a palette of greens and whites to create a light, bright and natural color scheme, following a meeting with the business owner it was preferable to them that their existing color scheme was carried into the site. </p>
<p>I worked with principal color scheme for the site of red, black and white. Having researched E-commerce platforms operating in a similar market I found that this scheme was popular and contrasted well with the products.</p>

**White #FFFFFF**
<p>White is the primary background color. I have used a collage of garden plans and garden layout sketches with a low opacity as background on some pages which helps create depth to the pages. The collage consists of images from Pinterest that I edited and altered with an image editing application.</p>
<p>

**Black #000000**
<p>I use black and white on the styling of the buttons and as strong bold on text elements.</p>

**Red #CF0808 and #FF0000**
<p>I have used two reds, I have a standard bright red, #FF0000, and flatter and darker red, #CF0808. The latter is the red which best matches the color that the business had been using in its branding and is a more toned down red and does not invoke the as much 'danger' and the #FF0000.</p>
<p>The brighter red, #FF0000, is only used a background color on a text carousel feature on the home page. Its primary function here to attract attention.</p>
<p>While the color red has plenty of energy and is an extremely sucessful color for many brands such as Coca Cola, McDonalds and Ferrari there are some psycological issues with it as color. Red is often the color of warnings and danger and so I have limited its use as hover activation color on the nav-bar and as a then border around the product category tiles which activates on a hover function as visual indication.</p>
<br>

<p align="center" width="100%"> 
<img src="readme_docs/images/colour_scheme.png" alt="color scheme" width=""/>
</p>
​
<br>

#### **Agile Methodology**

The design, development and testing of this application were tracked through a Kanban board in a created GitHub project.

[Link to Kanban Board](https://github.com/users/TNolan01/projects/5)
<br>

<p align="center" width="100%"> 
<img src="readme_docs/images/kanban_sample.png" alt="sample of Kanban" width=""/>
</p>

<br>


[Back to content](#contents)
​
## Marketing Strategy

### SEO - Search Engine Optimization

#### Keyword Research




---
## Wireframes
​
### **Site Layout**

<p>The initial layout for the site was layout with wireframes created in Balsamiq. These images can be viewed via the link below.</p>

<br>

<p> When the wireframes were rendered on screen with Bootstrap, HTML and CSS there were slight changes to the UX design and layout. As the development process continued further style changes were made in the screen layout. The layout was altered in line with some live testing.

​[Link to Wire Frames](readme_docs/wireframes/Wire_Frames.pdf

[Back to content](#contents)
​

---
​
## Information Architecture
​
### **PostgreSQL Database**
The backend database is a PostgreSQL Database hosted via Heroku. The database is built around several seperate apps including the following apps.
<br>

#### **Apps and associated models:**
<ul>
<li> </li>

</ul>
<br>


<br>


**Model 1**

Text 

**Model 2**

Text

[Future Features](#future-features).

**Model 3**

Text

**Model 4**

Text



​
[Back to content](#contents)
​

---
​
## Technologies
​
### Languages
​
- [HTML](https://developer.mozilla.org/en-US/docs/Web/HTML)
- [CSS](https://developer.mozilla.org/en-US/docs/Web/CSS)
- [JavaScript](https://developer.mozilla.org/en-US/docs/Web/JavaScript)
- [Python](https://www.python.org/)
​
### Libraries & Frameworks
​
- [Django](https://www.djangoproject.com/)
- [Google Fonts](https://fonts.google.com/)
- [Font Awesome](https://fontawesome.com/)
- [Favicon](https://favicon.io/)
- [jQuery](https://jquery.com/)
- [Bootstrap](https://getbootstrap.com/)
- [Crispy Forms](https://django-crispy-forms.readthedocs.io/en/latest/)
- [Pillow](https://pypi.org/project/Pillow/)
- [Stripe](https://stripe.com/ie)
- [Crispy Forms](https://django-crispy-forms.readthedocs.io/en/latest/#)
- [baguetteBox](https://feimosi.github.io/baguetteBox.js/)
​
### Tools
​
- [Git](https://git-scm.com/)
- [GitHub](https://github.com/)
- [Balsamiq](https://balsamiq.com/) - Wireframe tool
- [3D Paint](https://apps.microsoft.com/store/detail/paint-3d/9NBLGGH5FV99)
- [Affinity](https://affinity.serif.com/en-us/)

### Deployment

- [Heroku](https://www.heroku.com/)
- [AWS, Amazon Web Services](https://aws.amazon.com)

[Back to content](#contents)

---
​
## Features
​
The application uses a PostgreSQL database which contains the purpose designed models with back-end being built on the Django Framework. The site is designed to with following base features.
<br> 

​- The site has **responsive design** when viewed on a mobile, tablet, and desktop.

- **Easy navigation** to external sites, such as social media accounts.

- **Visually appealing** images and content.

### Implemented Features

**Nav Bar**
<p>The Nav Bar is standard across all pages. It contains a link to <strong>Home</strong>, <strong>Contact Us</strong>, and an <strong>Inspiration Page</strong> which is a picture gallery. </p>
<p>There is a drop down menu for navigation to the different product categories and an Account link to allow new users register or login if already registered. Beside this there is a basket icon which will show current total of items in the basket if there are any.</p>
<p>Positioned on the right of the nav-bar is the search function to search through products for key words. </p>
<p>I have also incorporated the company logo into the nav bar as part of the branding.</p>
<p>Nav bar link text will turn red on hover to further highlight the options and introduce some red into the color scheme.</p>
<br>

<p align="center" width="100%"> 
<img src="readme_docs/images/navbar.png" alt="image of navbar" width=""/>
</p>

<strong>Administrator Function:</strong>
<p>If the user is logged in as the site administrator the 'My Account' drop will include four additional links.</p>
<ul>
<li>Product Management</li>
<li>Update Site Banner</li>
<li>Newsletter</li>
<li>Email List</li>
</ul>
<br>

<p align="center" width="100%"> 
<img src="readme_docs/images/admin_menu.png" alt="image of navbar admin" width=""/>
</p>
<br>

<strong>Product Management</strong>
<p>This option allows the administrator to add and new product to the site.</p>
<br>

<strong>Update Site Banner</strong>
<p>Update Site Banner option allows the administrator to change to text content and the header of one of the text-carousels which auto slide under the image carousel on the home page. This allows the administrator access to put a quick message directly on the home page.</p>
<br>

<strong>Newsletter</strong>
<p>The administrator can see all products currently available as 'special offers' which would form part of the newsletter sent to subscribers.</p>
<br>

<strong>Email List</strong>
<p>This link will show a list of all emails currently subscribed to the newsletter. From here the admin can also delete an email address from that list.</p>
<br>

<p align="center" width="100%"> 
<img src="readme_docs/images/newsletter_admin.png" alt="image of newsletter admin" width=""/>
</p>
<br>

**Footer**
<p>Like the nav bar the footer is standard across all pages. The footer contains links to company social media channels.</p>
<br>

**Home Page**
<p>The home page contains a large picture carousel which auto scrolls. This is positioned just below the nav bar. The carousel contains four seperate images. Each image is overlayed with a text box and each text box contains a button. The text relates to the image and the destination for the associated button will bring to a relevant point on the site inline with image and text. The purpose of the carousel is to act as four advertments.</p>
<p>The central content of the homepage are the product cards. These cards contain text and an image. Each card will bring you to a seperate product category page. The borders on the cards will turn red when hovered over. The images are to be visually appealing and need to represent the relevant product category.</p>
<p>Below the product cards and over the footer there a 'supplier slider', this is another carousel which contains logo's for the companies whom supply products to the business. This is auto scrolling. At present if a user clicks on a supplier logo they are taken to that suppliers website, which opens in a new page. As a future feature I would look at returning a template of all products available relating to the particular supplier for purchase on this site.</p>
<br>

<p align="center" width="100%"> 
<img src="readme_docs/images/supplier_slider.png" alt="image of supplier slider" width=""/>
</p>
<br>

**Contact Us**

<p>Self explanatory, this page contains all the relevant contact details for the business. There is also a contact us form to allow the site user quickly send there queries and contact details to the business.</p>
<p>I have included social media links here also. I have also included an opening hours feature which shows the current day highlighted in red.</p>
<p>Below the contact details and contact us form there is link to subscribe to the newsletter. There is animated border around this button to attract the site users attention.</p>
<p>This page also contains an embedded Google Map with the location of the business central on the rendered map. Just below the map there is link to allow any user subscribed to newsletter to unsubscribe, naturally if the user tries to unsubscribe from the newsletter mailing list with an email address thats not on the list they will receive a validation error message.</p>
<br>

<p align="center" width="100%"> 
<img src="readme_docs/images/unsubscribe_letter.png" alt="image of unsubscribe" width=""/>
</p>
<br>

**Inspiration** 

<p>This page would form part of the larger marketing strategy, the page is essentially and image gallery which is built using BaguetteBox which is a JavaScript library, that generates a lightbox with animated and responsive images. There are currently nine images in the gallery but this would be expanded.</p>
<p>The images 'zoom on hover', as part of that function description text for each image is also displayed. If a user clicks on any image the image will occupy full screen. And exit control and left and right directional arrows will be shown. The user can now scroll through all the images in the gallery or exit back to grid display mode.</p>

**Products Page** 

<p>The product page will display a card for each product item matching the user selected category, the name of the category will be displayed at the top of the page. Below this to the left the number of products in this category will be displayed and on the right will be the 'Sort By' dropdown options box. </p>
<p>The users can sort the displayed products in the following ways:</p>
<ul>
<li>Price - low to high</li>
<li>Price - high to low</li>
<li>Rating - low to high</li>
<li>Rating - high to low</li>
<li>Name - A to Z</li>
<li>Name - Z to A</li>
<li>Category - A to Z</li>
<li>Category - Z to A</li>
</ul>
<br>

<p>The border around the product card will also turn red on hovering over the particular card. Once a particular product card is selected a products detail page is displayed for that particular product. The image will be on the left of the screen and the details and price will be displayed on the right. Just below the details will be the quantity box which the user can use to alter the quantity of the product required. Clicking the 'ADD TO BASKET' button will deposit the quantity selected into the basket.</p>
<p>The 'KEEP SHOPPING' button will return the user back to the products section.</p>
<p>Clicking the product image will that image in a new window in a full screen size.</p>


### Future Features


[Back to content](#contents)
​

---
​
## Development

<p>In this section I deal with some of the bugs and errors encountered during the development process. If the issue was sucessfully fixed I have included details of that fix.</p>

## Bugs & Fixes
<p>This section consists of issues I had during development which took me 60 minutes plus approximately to identify and sort.</p>

### Issue No.1
<h4>Webhooks and Stripe:</h4>
<p>During the setup of the Stripe webhooks I was initially not able to get 'intent' details back and printed to the terminal. After some investigation I discovered that this was because Port 8000 was set to Private and not Public as was required. Once this was created the transaction information was printed to the terminal.</p>

### Issue No.2 
<h4>Webhooks the return!:</h4>
<p>Having successfully tested the webhooks in the development environment I moved on to other aspects of the project. I approached a point where I needed to test User Stories and so setup an email address and setup webhooks in Stripe with a new endpoint URL for the deployed site and tested.</p>
<p>While test payments were being sucessfully recieved and processed in Stripe none of the webhooks were functioning and emails were not being sent. The Stripe dashboard returninf a 500 Error.</p>
<p>After a period of unsucessful testing I had to create a new endpoint in Stripe with an URL of my development environment. I edited the webhook secret to matched and tested the functions in the development site with feedback in the terminal. The Error 500 was traced back to typo in the webhook_handler.py. Once the error was corrected I changed the webhook secret back to deployed site value and retested.</p>
<p>Testing was nowing showing that webhooks were functioning correctly and emails were sent successfully.</p>


---

## Testing
​
## Functional Testing
The testing and result of same are located in a separate file​.

Testing results [here](TESTING.md)
<br>​
​

## Validator Testing

​
### <span style="color:#56a832; font-weight:bold; font-size:20px">CSS</span>
​
CSS was tested using [W3C CSS Validation Tool](https://jigsaw.w3.org/css-validator/)
​​<br>


​
### <span style="color:#ebd80c; font-weight:bold; font-size:16px">JavaScript</span>

The script.js file was tested with [JSHint](https://jshint.com/) and showed no errors or warnings. 
​<br>


### <span style="color:#56a832; font-weight:bold; font-size:20px">HTML</span>
​
HTML files associated with this project were tested individually with [W3C Validator](https://validator.w3.org/) and showed no errors or warnings. 
<br>


### <span style="color:#edb80c; font-weight:bold; font-size:20px">Python</span>
​
I have tested Python code in this project with [PEP8](http://pep8online.com/). The only error located in some of the Python files are a number of <span style="color:#FF0000; font-weight:bold">E501</span> errors which are <span style="color:#FF0000; font-weight:bold">line too long (a line greater than 79 characters)</span>.

I have decided not to alter the relevant lines to fit into 79-character restriction. 
- Having researched the options there is some mention of the effects on Django.
- I believe it would reduce of the readability of the code to chop lines.

​<br>
<p align="center" width="100%"> 
<img src="media/testing/views_PEP8.png" alt="PEP8 test image" width=""/>
</p>
<br>



---

### <span style="color:#ebd80c; font-weight:bold; font-size:16px">Light House Performance Testing</span>

### Desktop Performance :
<br>
<p align="center" width="100%"> 
<img src="media/testing/performance_desktop.png" alt="desktop test" width=""/>
</p>
<br>


### Mobile Performance :
<br>
<p align="center" width="100%"> 
<img src="media/testing/performance_mobile.png" alt="mobile test" width=""/>
</p>
<br>

<br>
<p align="center" width="100%"> 
<img src="media/testing/performance_mobile.png" alt="mobile test" width=""/>
</p>
<br>

<br>
<p align="center" width="100%"> 
<img src="media/read_me/mobile_phone.png" alt="mobile phone image" width=""/>
</p>
<br>

[Back to content](#contents)
​

## User Test Information 

In conjuction with creating a new 'visitor' login the following login information can be used to test the site.

[Link to User Stories](readme_docs/user_stories/User%20Stories.pdf)

<br>


<br>

---
​
## Deployments
​
### Deployment:

<br>

Deployment of this project is carried out with Heroku, https://www.heroku.com. The deployment procedure is a follows.  
<ol>
<li>Log in to Heroku, creating a new account if you are not a current user.</li>
<li>Click on the 'New' button in the top right corner and from the drop-down menu select 'Create new app'.</li>
<li>Create an App name and select your Region from menu.</li>
<li>Click the 'Create App' button.</li>
<li>Click in resources and select Heroku Postgres as the project database.
<li>You will now have a menu for your new app. From here click on the Settings Tab and in the Config Vars. Click Reveal Config Vars. <br>
<ul>
<li>add your Secret Key</li>
<li>add PostgreSQL URL</li>
<li>add PORT with value '8000'</li>
<li>add a record - 'DISABLE_COLLECTSTATIC = 1'</li> 
</ul>
</li>

<br>
<p align ="center">
<img title="heroku" alt="screen shot of Heroku app menu" src="media/read_me/config_vars.png"></p>
<br>

<li>Scroll down to the Buildpacks section. Click Add buildpack. From the menu select heroku/python and click Save Changes. </li>

<br>
<p align ="center">
<img title="heroku" alt="screen shot of Heroku app menu" src="media/read_me/heroku_buildpack.png"></p>
<br>

<li>Return to menu at the top of the page and click on Deploy. Select Github as the deployment method.</li>
<li>Confirm you want to connect to GitHub using your account credentials for Git. Once Heroku has access search for the relevant repository name and click the connect button.</li>
<li>At the bottom of the deploy page select the preferred deployment type. You can use Manual Deploy which will deploy based on the current state of the selected Git branch. You can also Enable Automatic Deploys for automatic deployment when you push updates to Github selected branch.</li>
</ol>
<br>

## Amazon AWS 
### Setting AWS bucket


1. Create an account AWS [Amazon Web Services](https://aws.amazon.com/) or login to an existing account (Credit Card required to register an account.)

2. Navigate to the AWS Managment Console and search for S3 Service.

3. Create a S3 Bucket using **Create Bucket** button in top right hand corner

4. Name the Bucket, in this instance we match the Heroku App name for simplicity.

5. Choose the AWS Region closest to you. 

6. Setup the **Object Ownership**.
- Select - **ACLs Enabled** 
- Select - **Bucket Owner Preffered**

7. Select **Allow Public Access**. Confirm that this setup will make the objects within the bucket viewable by the public.

8. Select **Create Bucket**

9. From your AWS dashboard select your Bucket. Select the **Properties** options and scroll down **Static Website Hosting**. Select Edit, click enable, fill in index doc as index.html and error.html for error option.

10. Within the **Permissions** section find Cross-Origin Resource Sharing, known as **CORS**. Copy code below paste into this in as the new configuration and confirm with 'save'. 

```
[
  {
      "AllowedHeaders": [
          "Authorization"
      ],
      "AllowedMethods": [
          "GET"
      ],
      "AllowedOrigins": [
          "*"
      ],
      "ExposeHeaders": []
  }
]
```
11. Edit the **Bucket Policy** by going to the permissions tab. Select the AWS Policy Generator.

Fill out this page as follows:
**Select Type of Policy** : S3 Bucket policy
**Principal** : * (this allows all)
**Actions**: Get object
**Amazon Resource Name (ARN)** : Copy ARN foom the Edit Bucket Policy page in the permissions section and paste it in here

Select **Add Statement** button. 
<br>
<p align ="center">
<img title="heroku" alt="screen shot of Heroku app menu" src="readme_docs/images/bucket_policy.png"></p>
<br>

12. Under Step 3, click **Generate Policy** button.
Than Click Generate Policy, the policy will appear on the screen in a window. Copy this policy into the **Bucket Policy Editor**. When copied, add <strong>/*</strong> to end of the **Resource** line.
Save the policy.

13. Go to the **Access control list (ACL)**, click Edit and enable **List** for **Everyone** which is **Public Access**.

14. From AWS Services menu locate **Identity and Access Management (IAM)**.
On the side menu find **User Groups** and click **Create Group**. Enter a name relevant to the groups purpose ie, "manage--app-name". Create the group.

15. From side menu select Policies and click **Create Policy**. 
Select the Import Managed Polic. Search for **AmazonS3FullAccess** and import that policy.

16. To restrict access to just the new bucket you must retrieve the ARN fromt the **Bucket Policy Page** in S3.
Copy ARN again and paste into "Resource" section. 
Add the ARN twice with a <strong>/*</strong> on the second ARNist containint The first line is for access to the Bucket and second line is for all files and folders in that Bucket.
<br>
<p align ="center">
<img title="heroku" alt="screen shot of Heroku app menu" src="readme_docs/images/bucket_policy.png"></p>
<br>

17. Select **Add Tags** click Next and on to **Review Policy**. Give the policy a name and a description.

18. Click **Create Policy**. Policy is now created.

19. From **Groups** option in side menu locate our group and select **Permissions** tab and the **Attach Policy** option. Search for the newly created policy and select **Attach Policy**.

20. Select **Users** in the side menu and click **Add User**, create a user in the following format <strong>your-app-staticfiles-user</strong>.
Give the new user **Programmatic Access**.
Add new User to new Group.

21. Select **Tags** and the click **Next** to the Review. Click **Create User**.

22. Download the generate file which is in a .CSV format and has your required security keys.
Click Next Tags and Next: review and Create user
- Download .csv file

### Setting AWS bucket

1. To Connect Django to the new AWS S3 Bucket, run the following commands from the terminal.
- Install boto3 'pip3 install boto3'
- Install django-storages 'pip3 install django-storages'
- Update requirements.txt 'pip3 freeze > requirements.txt'

Update settings.py by including **storages** on the list of installed apps.

Add the following settings to settings.py. to link the Bucket. (Keeping AWS Access keys safe.)

```
if 'USE_AWS' in os.environ:
    # Cache control
    AWS_S3_OBJECT_PARAMETERS = {
        'Expires': 'Thu, 31 Dec 2099 20:00:00 GMT',
        'CacheControl': 'max-age=94608000',
    }

    # Bucket Config
    AWS_STORAGE_BUCKET_NAME = tw-shop
    AWS_S3_REGION_NAME = 'eu-west-1'
    AWS_ACCESS_KEY_ID = os.getenv('AWS_ACCESS_KEY_ID')
    AWS_SECRET_ACCESS_KEY = os.getenv('AWS_SECRET_ACCESS_KEY')
    AWS_S3_CUSTOM_DOMAIN = f'{AWS_STORAGE_BUCKET_NAME}.s3.amazonaws.com'
```

2. Go into the Heroku dashboard and select the relevant app to set up our enviromental variables.

Add the following to your Config Vars.
**AWS_ACCESS_KEY_ID** and enter key value from downloaded CSV file.
**AWS_SECRET_ACCESS_KEY** and enter key value from downloaded CSV file.
**USE_AWS** and enter a value of True.
You can now remove **DISABLE_COLLECTSTATIC** from the Config Vars section.

3. Create a new file in root directory called **custom_storages.py**

```
from django.conf import settings
from storages.backends.s3boto3 import S3Boto3Storage


class StaticStorage(S3Boto3Storage):
    location = settings.STATICFILES_LOCATION


class MediaStorage(S3Boto3Storage):
    location = settings.MEDIAFILES_LOCATION
```

4. Update the settings.py with the following AWS settings

```
    # Static and media files
    STATICFILES_STORAGE = 'custom_storages.StaticStorage'
    STATICFILES_LOCATION = 'static'
    DEFAULT_FILE_STORAGE = 'custom_storages.MediaStorage'
    MEDIAFILES_LOCATION = 'media'

    # Override static and media URLs in production
    STATIC_URL = f'https://{AWS_S3_CUSTOM_DOMAIN}/{STATICFILES_LOCATION}/'
    MEDIA_URL = f'https://{AWS_S3_CUSTOM_DOMAIN}/{MEDIAFILES_LOCATION}/'

```

5. The easist way to upload the media files to AWS S3 Bucket is to open the Bucket in AWS dashboard, create a new folder called **media**. From here you can select **Upload** and select the file or files you want to upload.




## Final Deployment
<ul> 
<li>Create a runtime.txt file - 'python 3.8.13'</li>
<li>Run the command - 'web: gunicorn "name of project".wsgi'</li>
<li>In 'settings.py' change the DEBUG to 'DEBUG = False'</li>
<li>In the Heroku dashboard for this app, navigate to 'settings' and delete the entry for DISABLE_COLLECTSTATIC</li>
</ul>


[Back to Contents](#contents) 
<br>

## Cloning:

[Click here](https://help.github.com/en/github/creating-cloning-and-archiving-repositories/cloning-a-repository#cloning-a-repository-to-github-desktop) to retrieve pictures for some of the buttons and more detailed explanations of the above process.

1. Log in to GitHub and locate the [GitHub Repository] https://github.com/TNolan01/tommy1
2. Under the repository name, click "Code".
3. To clone the repository using HTTPS. Under "HTTPS" copy the link.
4. Go to your local terminal with git installed
5. Change the current working directory to the location where you want the cloned directory to be created/located.
6. Type `git clone` and then you paste in the URL you copied in Step 3.

  ```
  $ git clone https://github.com/TNolan01/tommy1
  ```

7. Press Enter. Your local clone will be created.

<br>

[Back to Contents](#contents) 
<br>
​

---

​
## Credits
​
### **Images**
​
I have not used any images for this application.
​
### **Image editing**
The logo I use was created with MS Paint with Favicon used to generate a Favicon icon.
​
### **Programming resources**
Aside from the Code Institute content for this section I used the following resources.

- [Stack Overflow](https://stackoverflow.com/)
- [CodeMy.Com on YouTube](https://www.youtube.com/watch?v=HHx3tTQWUx0&list=PLCC34OHNcOtqW9BJmgQPPzUpJ8hl49AGy&index=2)
- [Dennis Ivy](https://www.youtube.com/watch?v=tUqUdu0Sjyc&t=1469s)
- [Ben Goddard(Codepen)](https://codepen.io/bengoddard)

<br>

[Back to content](#contents)
​

---
​
